######## ports
redir-port: 9797
tproxy-port: 9898

mixed-port: 8486

######## basics
mode: rule
allow-lan: true

log-level: warning

find-process-mode: always

######## web ui
external-controller: :9090
# external-ui: metacubexd
external-ui: zashboard
external-ui-url: "https://github.com/Zephyruso/zashboard/archive/refs/heads/gh-pages.zip"
secret: 998486
profile:
  store-selected: true
  store-fake-ip: true

######## tun
tun:
  enable: true
  stack: mixed
  auto-route: true
  auto-detect-interface: true
  dns-hijack:
    - any:53

######## dns
dns:
  enable: true
  listen: :53
  enhanced-mode: fake-ip
  fake-ip-range: 16.0.0.1/8

######## anchors in proxy groups
all-proxies-anchor: &all-proxies-anchor
  type: select
  include-all: true

default-proxies-anchor: &default-proxies-anchor
  type: select
  include-all: true
  proxies: [ğŸš€ é»˜è®¤, ğŸ‡ºğŸ‡¸ ç¾å›½, ğŸ‡¨ğŸ‡³ å°æ¹¾, ğŸ‡­ğŸ‡° é¦™æ¸¯, ğŸ‡¸ğŸ‡¬ ç‹®åŸ, ğŸ‡¯ğŸ‡µ æ—¥æœ¬, DIRECT]

######## proxy groups
proxy-groups:
  # Default
  - name: ğŸš€ é»˜è®¤
    <<: *all-proxies-anchor
    proxies: [ğŸ‡ºğŸ‡¸ ç¾å›½, ğŸ‡¨ğŸ‡³ å°æ¹¾, ğŸ‡­ğŸ‡° é¦™æ¸¯, ğŸ‡¸ğŸ‡¬ ç‹®åŸ, ğŸ‡¯ğŸ‡µ æ—¥æœ¬]

  # Regions
  - name: ğŸ‡ºğŸ‡¸ ç¾å›½
    <<: *all-proxies-anchor
    filter: "US|ğŸ‡ºğŸ‡¸|ç¾å›½"

  - name: ğŸ‡¨ğŸ‡³ å°æ¹¾
    <<: *all-proxies-anchor
    filter: "TW|ğŸ‡¨ğŸ‡³|ğŸ‡¹ğŸ‡¼|å°æ¹¾"

  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯
    <<: *all-proxies-anchor
    filter: "HK|ğŸ‡­ğŸ‡°|é¦™æ¸¯"

  - name: ğŸ‡¸ğŸ‡¬ ç‹®åŸ
    <<: *all-proxies-anchor
    filter: "SG|ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®åŸ"

  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬
    <<: *all-proxies-anchor
    filter: "JP|ğŸ‡¯ğŸ‡µ|æ—¥æœ¬"

  # Services
  - name: Bahamut
    icon: https://i2.bahamut.com.tw/favicon.svg
    <<: *all-proxies-anchor
    # use ğŸ‡¨ğŸ‡³ å°æ¹¾ by default
    proxies: [ğŸ‡¨ğŸ‡³ å°æ¹¾, ğŸš€ é»˜è®¤, ğŸ‡ºğŸ‡¸ ç¾å›½, ğŸ‡­ğŸ‡° é¦™æ¸¯, ğŸ‡¸ğŸ‡¬ ç‹®åŸ, ğŸ‡¯ğŸ‡µ æ—¥æœ¬, DIRECT]

  - name: EHentai
    icon: https://e-hentai.org/favicon.ico
    <<: *all-proxies-anchor
    # use ğŸ‡ºğŸ‡¸ ç¾å›½ by default
    proxies: [ğŸ‡ºğŸ‡¸ ç¾å›½, ğŸš€ é»˜è®¤, ğŸ‡¨ğŸ‡³ å°æ¹¾, ğŸ‡­ğŸ‡° é¦™æ¸¯, ğŸ‡¸ğŸ‡¬ ç‹®åŸ, ğŸ‡¯ğŸ‡µ æ—¥æœ¬, DIRECT]

  - name: Microsoft
    icon: https://www.microsoft.com/favicon.ico?v2
    <<: *default-proxies-anchor

  - name: Netflix
    icon: https://www.netflix.com/favicon.ico
    <<: *default-proxies-anchor

  - name: Nikke
    icon: https://nikke-en.com/favicon.ico
    <<: *default-proxies-anchor

  - name: SteamCN
    icon: https://store.steampowered.com/favicon.ico
    <<: *all-proxies-anchor
    # use DIRECT by default
    proxies: [DIRECT, ğŸš€ é»˜è®¤, ğŸ‡ºğŸ‡¸ ç¾å›½, ğŸ‡¨ğŸ‡³ å°æ¹¾, ğŸ‡­ğŸ‡° é¦™æ¸¯, ğŸ‡¸ğŸ‡¬ ç‹®åŸ, ğŸ‡¯ğŸ‡µ æ—¥æœ¬]

  - name: Telegram
    icon: https://telegram.org/img/favicon.ico
    <<: *default-proxies-anchor

  - name: YouTube
    icon: https://www.gstatic.com/youtube/img/branding/favicon/favicon_144x144_v2.png
    <<: *default-proxies-anchor

######## proxy providers
proxy-providers:
  Local:
    type: file
    path: ./proxies/Local.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 7200

  # Subscription:
  #   type: http
  #   # your subscription url here
  #   url: https://your.subscription.url
  #   path: ./proxies/Subscription.yaml
  #   health-check:
  #     enable: true
  #     url: http://www.gstatic.com/generate_204
  #     interval: 7200

######## rule providers
rule-anchor:
  domain: &domain { type: http, interval: 86400, behavior: domain, format: mrs }
  cidr: &cidr { type: http, interval: 86400, behavior: ipcidr, format: mrs }

rule-providers:
  # Custom Local Rules
  custom-direct:
    type: file
    behavior: domain
    path: ./custom-rules/direct.yaml

  custom-proxy:
    type: file
    behavior: domain
    path: ./custom-rules/proxy.yaml

  custom-reject:
    type: file
    behavior: domain
    path: ./custom-rules/reject.yaml

  # Meta Rules https://github.com/MetaCubeX/meta-rules-dat/blob/meta/geo/geosite
  # Domain Rules
  apple:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple.mrs"

  bahamut:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bahamut.mrs"

  cn:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs"

  ehentai:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/ehentai.mrs"

  icloud:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/icloud.mrs"

  microsoft:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/microsoft.mrs"

  netflix:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.mrs"

  nikke:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/nikke.mrs"

  private:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.mrs"

  steam@cn:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/steam@cn.mrs"

  telegram:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs"

  youtube:
    <<: *domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs"

  # CIDR Rules
  cncidr:
    <<: *cidr
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs"

  privatecidr:
    <<: *cidr
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/private.mrs"

  telegramcidr:
    <<: *cidr
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat//meta/geo/geoip/telegram.mrs"

rules:
  # Custom Local Rules
  - RULE-SET,custom-direct,DIRECT
  - RULE-SET,custom-reject,REJECT
  - RULE-SET,custom-proxy,ğŸš€ é»˜è®¤
  # Meta Domain Reject
  # None yet
  # Meta Domain Selectable
  - RULE-SET,bahamut,Bahamut
  - RULE-SET,ehentai,EHentai
  - RULE-SET,microsoft,Microsoft
  - RULE-SET,netflix,Netflix
  - RULE-SET,nikke,Nikke
  - RULE-SET,steam@cn,SteamCN
  - RULE-SET,telegram,Telegram
  - RULE-SET,youtube,YouTube
  # Meta Domain Direct
  - RULE-SET,apple,DIRECT
  - RULE-SET,cn,DIRECT
  - RULE-SET,icloud,DIRECT
  - RULE-SET,private,DIRECT
  # Meta Domain Proxy
  # None yet
  # Meta CIDR Reject
  # None yet
  # Meta CIDR Selectable
  - RULE-SET,telegramcidr,Telegram,no-resolve
  # Meta CIDR Direct
  - RULE-SET,cncidr,DIRECT,no-resolve
  - RULE-SET,privatecidr,DIRECT,no-resolve
  # Meta CIDR Proxy
  # None yet
  # Others
  - MATCH,ğŸš€ é»˜è®¤
